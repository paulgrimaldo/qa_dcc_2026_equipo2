# Presentación Equipo ___ — Revisión Semanas 3 y 4

---

## Slide 1 — Semana 3: Top 3 riesgos (priorización)
**SUT:** Spring Rest Pet Clinic  
**Fuente (repo):** `risk/matriz_riesgos.csv`

**Top 3 riesgos:**
| ID | Descripción del Riesgo | Score |Por qué |
|----|------------------------|---------|---------|
| R1 | El contrato OpenAPI del SUT Pet Clinic REST no está disponible porque el servicio se encuentra caído o el endpoint `/v3/api-docs` no responde. | Impacto 5 / Probabilidad 3 / Score 15 | Es un riesgo bloqueante si el contrato de la API no responde ninguna otra prueba es posible
| R2 | El SUT considera válidas entradas incorrectas en `GET /api/pets/{id}` y responde con HTTP 200 cuando no corresponde. | Impacto 4 / Probabilidad 3 / Score 12 | El SUT deberia responder HTTP 200 ante Ids validos y lanzar excepciones ante escenarios de errores controlados 
| R3 | Se observa latencia alta o muy variable en `GET /api/vets` dentro del entorno local. | Impacto 3 / Probabilidad 4 / Score 12 | Aunque es un entorno local se necesita una linea base para detectar degradaciones en el código


**Priorización:** ___

El top 3 responde a la formula `Riesgo = Impacto * Probabilidad `
- Se priorizó la funcionalidad profunda por que sin disponibilidad la calidad funcional es irrelevante
- La robustez es critica para prevenir corrupción de los datos o comportamientos impredecibles
- Se acepta la variabilidad del entorno local

---

## Slide 2 — Semana 3: Trazabilidad
**Fuente (repo):** `risk/estrategia_testing.md` y `evidence/week3/`


| Riesgo (ID) | Justificación | Escenario | Evidencia (Semana 3) | Oráculo mínimo | Riesgo residual |
|-------------|---------------|-----------|----------------------|----------------|-----------------|
| **R1 (Disponibilidad):** El contrato OpenAPI del SUT Pet Clinic Rest no está disponible porque el servicio se encuentra caído o el endpoint /v3/api-docs no responde | Impacto máximo sin contrato no existe consumo ni validación; probabilidad media debido a dependencias de Docker y del puerto (p. ej. SUT no iniciado, puerto ocupado o contenedor detenido) | Q1 | `evidence/week3/openapi.json`; `evidence/week3/openapi_http_code.txt` | pass si HTTP 200 y el cuerpo contiene `"openapi"` | No se garantiza disponibilidad sostenida; solo un punto en el tiempo |
| **R2 (Robustez):** El SUT considera válidas entradas incorrectas en GET /api/pets/{id} y responde con HTTP 200 cuando no corresponde | Puede ocultar errores en etapas posteriores con probabilidad media debido a la validación limitada observada; la validación es insuficiente o el manejo de errores es inconsistente en el endpoint de mascotas | Q3 | `evidence/week3/invalid_ids.csv`; `evidence/week3/invalid_pet_*.json` | pass si **ningún** caso de ID inválido devuelve HTTP 200 | No se valida la semántica del error (400 vs 404); solo “no 200” |
| **R3 (Rendimiento):** Se observa latencia alta o muy variable en GET /api/vets dentro del entorno local | Probabilidad alta por la variación del entorno local; impacto moderado al tratarse de línea base local y no de producción. Causas: recursos locales limitados, falta de warm-up adecuado o carga en el host | Q2 | `evidence/week3/latencia.csv`; `evidence/week3/latencia_total.txt` | pass si las mediciones devuelven HTTP 200; (opcional) p95 ≤ umbral definido | No se generaliza a producción ni se evalúa concurrencia |
---

## Slide 3 — Semana 3: Riesgo Residual
**Riesgos NO priorizados:**
- R4 Formato de los datos: Requiere alteraciones posteriores en el sistema por lo que la probabilidad es baja
- R6 Manejo de errores: El riesgo es moderado y puede ser miticado en mejoras futuras

**Riesgo residual**
- Para R1 se valida en un unico punto, por ejemplo responde 200 y luego se cae, es decir no garantiza disponibilidad. Se mitiga mediante `healthchecks`
- Para R2 Se prioriza la integridad de los datos sobre el manejo de los errores (que puede interpretarse como experiencia del usuario antes esos escenarios)
- Sobre R3, sirven como lineas bases relativas, se mitiga con entornos aislados para pruebas de producción
---

## Slide 4 — Semana 4: objeto de prueba + técnica sistemática
**Objeto de prueba (`api/vets/{id}`):** ___  
**Fuente (repo):** `design/test_cases.md`

**Justificación:**
- Alineado al negocio, es un endpoint que retorna un veterinario con las especialidades que este ofrece
- El endpoint presenta parámetros de entrada bien definidos y un espacio de valores acotado, lo que lo hace especialmente adecuado para técnicas de pruebas sistemáticas como *Equivalence classes* y *Boundary values analysis*
- Implicancia tecnologica, si bien se consulta un solo veterinario por `{id}` este internamente debe hacer `joins` para cruzar información con las especialidades que le corresponden al veterinario

**Técnica usada:**
- Input parameter Testing con las técnicas *Equivalence classes* y *Boundary Values analysis*

**Cómo derivamos los casos**
- Se identificaron valores representativos basado en las restricciones de dominio
- Se acotaron escenarios cercanos a los limites del dominio


**Cobertura que afirmamos y qué NO afirmamos:**


*Afirmamos:*
- Cobertura sistemática de las clases de entrada del parámetro `{id}` (EQ) y de los límites y formatos relevantes (BV), incluyendo variantes de formato, signo y idempotencia.
- Evidencia reproducible por caso: código HTTP, cuerpo guardado en `evidence/week4/<test_case_id>_response.json`, y decisión pass/fail bajo oráculo mínimo en `results.csv`.  
*No afirmamos:*

- Correctitud funcional completa del recurso `vets` (depende de datos existentes y de la lógica de negocio no ejercitada).
- Que el SUT cumpla estrictamente OR3 tal como está redactado en reglas (p. ej. “404 ante ausencia y 500 ante cualquier otro error”); el oráculo mínimo aplicado en el script prioriza “no 5xx” y coherencia de códigos para las particiones.
- Seguridad, concurrencia ni rendimiento en producción.
- Estabilidad temporal a largo plazo (requiere repetición controlada y monitoreo).

---

## Slide 5 — Semana 4: oráculos defendibles (mínimos vs estrictos)
**Fuente (repo):** `design/reglas_oraculos.md` y `evidence/week4/`

**Reglas de oráculo**
- (Mínima) OR-1: Todas las solicitudes registran `http_code` y persisten el cuerpo de la respuesta como evidencia
- (Mínima) OR-2: La respuesta **no** debe ser HTML (Verificación mediante `header` valor de `Content-Type=application/json` )
- (Estrica) OR-3: (Cupero de la respuesta no vacio en `http_code=200`): Si `http_code == 200` para el `{id}` numérico válido, el cuerpo no debería ser un JSON vacío `{}`.
- (Estrica) OR-4:(Consistencia semántica en `http_code=200`): Si `http_code == 200` para el `{id}` numérico válido, el cuerpo debería incluir un campo `"id"` (idealmente con el mismo valor).  
- (Estrica) OR-5:(Idenpotencia en input/output): Si se realizan ejecuciones secuenciales (Por ejemplo 5 ejecuciones con el mismo `{id}` todas las respuestas apuntan al mismo output). 

**Ambigüedad detectada y cómo se resolvió:**

- Se identificó un vacío en los criterios de prueba respecto a la consistencia semántica y la idempotencia, lo que permitía falsos positivos (respuestas vacías o incorrectas marcadas como válidas). Se resolvió definiendo explícitamente estas condiciones y agregándolas como reglas estrictas (OR-4 y OR-5), priorizando así la integridad de los datos sobre la simple disponibilidad del servicio

**Evidencia clave (2 archivos):**
- `evidence/week4/*`

---

## Slide 6 — Validez + mejora concreta
**Amenazas a la validez:**
- **Interna:** Los datos en el servidor (veterinarios) pueden cambiar, haciendo que un `{id}` válido pase de devolver `200` a `404`. Mitigación: Oráculos flexibles que aceptan {200, 404} para particiones válidas y uso de variables de entorno (`ID_EXISTENTE`) para inyectar datos conocidos.
- El diseño varía únicamente el parámetro {id}, ignorando posibles fallos desencadenados por la interacción con otros factores (Headers, Cookies, Estado de sesión), un riesgo clave citado en NIST SP 800-142. *Mitigación*: Se declara el alcance como Input Parameter Modeling unitario; no se afirma cobertura de integración o combinatoria compleja

- **Constructo:** Usar códigos HTTP y JSON válido como medida de calidad no garantiza seguridad ni corrección funcional completa (ej. el servidor podría devolver un JSON bien formado con datos erróneos). *Mitigación*: Se definen oráculos "Estrictos" (OR8, OR9) para evaluar consistencia semántica básica, aunque no sean bloqueantes.

- **Externa:** Los resultados (especialmente tiempos y errores 500) pueden depender de la infraestructura (Docker vs Local, Red). *Mitigación*: El reporte incluye la versión del SUT y el script permite configurar BASE_URL para replicar la prueba en distintos entornos, favoreciendo la generalización de los hallazgos.


**Cierre:**
Lo más defendible del trabajo no es el número de casos ni la ausencia de fallos, sino la aplicación consciente y sistemática de técnicas de prueba alineadas al riesgo, con oráculos explícitos y aceptación declarada del riesgo residual.